<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Aufgabe1</title>
    <style>
        table, th, td {
            border: solid 1px;
        }
    </style>
    <script>
        window.onload = function () {

// ---- Exel ---
            const table = document.querySelector('table');
            const result = document.getElementById('result');
            const nrOfRows = document.getElementById("x");
            const nrOfColums = document.getElementById("y");
            let leftTopCornerRow = document.getElementById('selectionTopLeftX');
            let leftTopCornerCol = document.getElementById('selectionTopLeftY');
            let rightBottomCornerRow = document.getElementById('selectionBottomRightX');
            let rightBottomCornerCol = document.getElementById('selectionBottomRightY');

            let tbody = table.createTBody();
            createTable();
            nrOfRows.onchange = createTable;
            nrOfColums.onchange = createTable;

            leftTopCornerRow.onchange = createTable;
            leftTopCornerCol.onchange = createTable;
            rightBottomCornerRow.onchange = createTable;
            rightBottomCornerCol.onchange = createTable;

            function createTable() {
                console.log('creating');
                tbody.remove();
                tbody = table.createTBody();
                for (let i = 0; i < nrOfRows.value; i++) {
                    let row = tbody.insertRow();
                    row.contentEditable = 'true';
                    for (let j = 0; j < nrOfColums.value; j++) {
                        let cell = row.insertCell();
                        cell.contentEditable = 'true';
                        cell.innerText = j;
                    }
                }

                let sum = 0;

                add();

                leftTopCornerRow.max = rightBottomCornerRow.value;
                leftTopCornerCol.max = rightBottomCornerCol.value;
                rightBottomCornerRow.min = leftTopCornerRow.value;
                rightBottomCornerCol.min = leftTopCornerCol.value;

                function add() {
                    console.log('Calculating..');
                    for (let k = leftTopCornerRow.value; k <= rightBottomCornerRow.value; k++) {
                        // iterate through rows
                        let row = tbody.rows[k];
                        for (let l = leftTopCornerCol.value; l <= rightBottomCornerCol.value; l++) {
                            //iterate through columns
                            let col = row.cells[l];
                            sum += parseInt(col.innerText);
                            col.style.backgroundColor = 'lightgrey';
                        }
                    }

                    result.innerText = sum;
                }

            }
        };

    </script>
</head>
<body>

<h2>A Spreadsheet</h2>
<p>Define the matrix dynamically.</p>
<p>
    <label for="x">X axis</label>
    <input type="number" id="x" value="4">
    <label for="y">Y axis</label>
    <input type="number" id="y" value="4">
</p>
<table></table>
<p> Sum of the selected fields:
    <span id="result"></span>
</p>
<div>
    <p>Input the top left corner of the area you want to select.</p>
    <label for="selectionTopLeftX">X-axis coordinate</label>
    <input type="number" id="selectionTopLeftX" value="1" min="0">
    <label for="selectionTopLeftY">Y-axis coordinate</label>
    <input type="number" id="selectionTopLeftY" value="1" min="0">
</div>

<div>
    <p>Input the bottom right corner of the area you want to select.</p>
    <label for="selectionBottomRightX">X-axis coordinate</label>
    <input type="number" id="selectionBottomRightX" value="2" min="0">
    <label for="selectionBottomRightY">Y-axis coordinate</label>
    <input type="number" id="selectionBottomRightY" value="2" min="0">
</div>


</body>
</html>
